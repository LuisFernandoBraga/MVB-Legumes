{% extends 'mvb/base.html' %}
{% block content %}

<h2 class="mb-3">Presen√ßas Registradas</h2>

<form method="GET" class="mb-3">
    <label class="fw-bold">Filtrar por funcion√°rio:</label>
    <select name="func" class="form-select w-50" onchange="this.form.submit()">
        <option value="">Todos</option>

        {% for f in funcionarios %}
            <option value="{{ f.id }}"
                {% if func_selected == f.id|stringformat:"s" %}
                    selected
                {% endif %}>
                {{ f.nome }}
            </option>
        {% endfor %}
    </select>
</form>

<a class="btn btn-primary mb-3" href="{% url 'mvb_dashboard' %}?tipo={{ tipo }}&data={{ request.GET.data }}&cliente={{ request.GET.cliente }}">
    Voltar
</a>

<table class="table table-bordered table-striped">
  <thead class="table-dark">
    <tr>
      <th>Data</th>
      <th>Funcion√°rio</th>
      <th>Status</th>
      <th>B√¥nus Semana</th>
      <th>B√¥nus M√™s</th>
      <th>A√ß√µes</th>
    </tr>
  </thead>

  <tbody>
    {% for p in presencas %}
    <tr>
      <td>{{ p.data|date:"d/m/Y" }}</td>
      <td>{{ p.funcionario.nome }}</td>

      <td>
        {% if p.status == "P" %}
            ‚úî Presente
        {% elif p.status == "F" %}
            ‚ùå Falta
        {% else %}
            üí§ Folga
        {% endif %}
      </td>

      <td>
        {% if bonus_semanal.p.funcionario.id %}
          <span class="badge bg-success">R$ 120</span>
        {% else %}
          <span class="badge bg-danger">Sem</span>
        {% endif %}
      </td>

      <td>
        {% if bonus_mensal.p.funcionario.id %}
          <span class="badge bg-primary">Cesta</span>
        {% else %}
          <span class="badge bg-secondary">Sem</span>
        {% endif %}
      </td>

      <td>
        <a class="btn btn-sm btn-primary" href="{% url 'editar_presenca' p.id %}">Editar</a>
        <a class="btn btn-sm btn-danger" href="{% url 'excluir_presenca' p.id %}">Excluir</a>
      </td>

    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}