{% extends 'mvb/base.html' %}
{% load mvb_extras %}
{% block content %}
<h1 class="mb-3">Controle de Presenças (Semana Atual)</h1>

<form method="post">{% csrf_token %}
<table class="table table-bordered table-sm align-middle">
  <thead class="table-secondary">
    <tr>
      <th>Funcionário</th>
      {% for d in dias %}
      <th>{{ d|date:"D d/m" }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for f in funcionarios %}
    <tr>
      <td>{{ f.nome }}</td>
      {% for d in dias %}
      {% with pres=presencas_map|get_item:f.id|stringformat:"s"|add:"_"|add:d.isoformat %}
      <td class="text-center">
        <input type="checkbox"
       name="pres_{{ f.id }}_{{ d.isoformat }}"
       {% if pres and pres.status == "P" %}checked{% endif %}>
      </td>
      {% endwith %}
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>

<div class="text-end">
  <button class="btn btn-success mt-3"><i class="fas fa-save"></i> Salvar Presenças</button>
</div>
</form>
{% endblock %}